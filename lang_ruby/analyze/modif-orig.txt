lots of small modifications:
 - fix warnings with recent OCaml (unused vars, unused rec)
 - split files in helpers, have smaller il file

