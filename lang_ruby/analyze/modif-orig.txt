lots of small modifications:
 - fix warnings with recent OCaml (unused vars, unused rec)
